const Joi = require('joi');
const { objectId } = require('./custom.validation');

const createRole = {
  body: Joi.object().keys({
    name: Joi.string().required(),
    description: Joi.string().allow(''),
    permissions: Joi.object().keys({
      viewProducts: Joi.boolean(),
      createProducts: Joi.boolean(),
      editProducts: Joi.boolean(),
      deleteProducts: Joi.boolean(),
      viewInvoices: Joi.boolean(),
      createInvoices: Joi.boolean(),
      editInvoices: Joi.boolean(),
      deleteInvoices: Joi.boolean(),
      printInvoices: Joi.boolean(),
      viewPurchases: Joi.boolean(),
      createPurchases: Joi.boolean(),
      editPurchases: Joi.boolean(),
      deletePurchases: Joi.boolean(),
      viewCustomers: Joi.boolean(),
      createCustomers: Joi.boolean(),
      editCustomers: Joi.boolean(),
      deleteCustomers: Joi.boolean(),
      viewSuppliers: Joi.boolean(),
      createSuppliers: Joi.boolean(),
      editSuppliers: Joi.boolean(),
      deleteSuppliers: Joi.boolean(),
      viewCategories: Joi.boolean(),
      createCategories: Joi.boolean(),
      editCategories: Joi.boolean(),
      deleteCategories: Joi.boolean(),
      viewReports: Joi.boolean(),
      viewSalesReports: Joi.boolean(),
      viewPurchaseReports: Joi.boolean(),
      viewInventoryReports: Joi.boolean(),
      viewCustomerReports: Joi.boolean(),
      viewSupplierReports: Joi.boolean(),
      viewProductReports: Joi.boolean(),
      exportReports: Joi.boolean(),
      viewUsers: Joi.boolean(),
      createUsers: Joi.boolean(),
      editUsers: Joi.boolean(),
      deleteUsers: Joi.boolean(),
      viewRoles: Joi.boolean(),
      createRoles: Joi.boolean(),
      editRoles: Joi.boolean(),
      deleteRoles: Joi.boolean(),
      viewSettings: Joi.boolean(),
      editSettings: Joi.boolean(),
      viewDashboard: Joi.boolean(),
      viewPayments: Joi.boolean(),
      createPayments: Joi.boolean(),
      editPayments: Joi.boolean(),
      deletePayments: Joi.boolean(),
    }),
    isActive: Joi.boolean(),
  }),
};

const getRoles = {
  query: Joi.object().keys({
    name: Joi.string(),
    isActive: Joi.boolean(),
    sortBy: Joi.string(),
    limit: Joi.number().integer(),
    page: Joi.number().integer(),
  }),
};

const getRole = {
  params: Joi.object().keys({
    roleId: Joi.string().custom(objectId),
  }),
};

const updateRole = {
  params: Joi.object().keys({
    roleId: Joi.required().custom(objectId),
  }),
  body: Joi.object()
    .keys({
      name: Joi.string(),
      description: Joi.string().allow(''),
      permissions: Joi.object().keys({
        viewProducts: Joi.boolean(),
        createProducts: Joi.boolean(),
        editProducts: Joi.boolean(),
        deleteProducts: Joi.boolean(),
        viewInvoices: Joi.boolean(),
        createInvoices: Joi.boolean(),
        editInvoices: Joi.boolean(),
        deleteInvoices: Joi.boolean(),
        printInvoices: Joi.boolean(),
        viewPurchases: Joi.boolean(),
        createPurchases: Joi.boolean(),
        editPurchases: Joi.boolean(),
        deletePurchases: Joi.boolean(),
        viewCustomers: Joi.boolean(),
        createCustomers: Joi.boolean(),
        editCustomers: Joi.boolean(),
        deleteCustomers: Joi.boolean(),
        viewSuppliers: Joi.boolean(),
        createSuppliers: Joi.boolean(),
        editSuppliers: Joi.boolean(),
        deleteSuppliers: Joi.boolean(),
        viewCategories: Joi.boolean(),
        createCategories: Joi.boolean(),
        editCategories: Joi.boolean(),
        deleteCategories: Joi.boolean(),
        viewReports: Joi.boolean(),
        viewSalesReports: Joi.boolean(),
        viewPurchaseReports: Joi.boolean(),
        viewInventoryReports: Joi.boolean(),
        viewCustomerReports: Joi.boolean(),
        viewSupplierReports: Joi.boolean(),
        viewProductReports: Joi.boolean(),
        exportReports: Joi.boolean(),
        viewUsers: Joi.boolean(),
        createUsers: Joi.boolean(),
        editUsers: Joi.boolean(),
        deleteUsers: Joi.boolean(),
        viewRoles: Joi.boolean(),
        createRoles: Joi.boolean(),
        editRoles: Joi.boolean(),
        deleteRoles: Joi.boolean(),
        viewSettings: Joi.boolean(),
        editSettings: Joi.boolean(),
        viewDashboard: Joi.boolean(),
        viewPayments: Joi.boolean(),
        createPayments: Joi.boolean(),
        editPayments: Joi.boolean(),
        deletePayments: Joi.boolean(),
      }),
      isActive: Joi.boolean(),
    })
    .min(1),
};

const deleteRole = {
  params: Joi.object().keys({
    roleId: Joi.string().custom(objectId),
  }),
};

const updateRolePermissions = {
  params: Joi.object().keys({
    roleId: Joi.string().custom(objectId),
  }),
  body: Joi.object().keys({
    viewProducts: Joi.boolean(),
    createProducts: Joi.boolean(),
    editProducts: Joi.boolean(),
    deleteProducts: Joi.boolean(),
    viewInvoices: Joi.boolean(),
    createInvoices: Joi.boolean(),
    editInvoices: Joi.boolean(),
    deleteInvoices: Joi.boolean(),
    printInvoices: Joi.boolean(),
    viewPurchases: Joi.boolean(),
    createPurchases: Joi.boolean(),
    editPurchases: Joi.boolean(),
    deletePurchases: Joi.boolean(),
    viewCustomers: Joi.boolean(),
    createCustomers: Joi.boolean(),
    editCustomers: Joi.boolean(),
    deleteCustomers: Joi.boolean(),
    viewSuppliers: Joi.boolean(),
    createSuppliers: Joi.boolean(),
    editSuppliers: Joi.boolean(),
    deleteSuppliers: Joi.boolean(),
    viewCategories: Joi.boolean(),
    createCategories: Joi.boolean(),
    editCategories: Joi.boolean(),
    deleteCategories: Joi.boolean(),
    viewReports: Joi.boolean(),
    viewSalesReports: Joi.boolean(),
    viewPurchaseReports: Joi.boolean(),
    viewInventoryReports: Joi.boolean(),
    viewCustomerReports: Joi.boolean(),
    viewSupplierReports: Joi.boolean(),
    viewProductReports: Joi.boolean(),
    exportReports: Joi.boolean(),
    viewUsers: Joi.boolean(),
    createUsers: Joi.boolean(),
    editUsers: Joi.boolean(),
    deleteUsers: Joi.boolean(),
    viewRoles: Joi.boolean(),
    createRoles: Joi.boolean(),
    editRoles: Joi.boolean(),
    deleteRoles: Joi.boolean(),
    viewSettings: Joi.boolean(),
    editSettings: Joi.boolean(),
    viewDashboard: Joi.boolean(),
    viewPayments: Joi.boolean(),
    createPayments: Joi.boolean(),
    editPayments: Joi.boolean(),
    deletePayments: Joi.boolean(),
  }).min(1),
};

module.exports = {
  createRole,
  getRoles,
  getRole,
  updateRole,
  deleteRole,
  updateRolePermissions,
};
